<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-hello-world" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/10/03/hello-world/" class="article-date">
  <time class="dt-published" datetime="2021-10-02T18:23:54.280Z" itemprop="datePublished">2021-10-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/10/03/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/10/03/hello-world/" data-id="ckua4t7hu001gvxgt5o2e2ncu" data-title="Hello World" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-toYMJ" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/02/09/toYMJ/" class="article-date">
  <time class="dt-published" datetime="2021-02-08T17:09:04.271Z" itemprop="datePublished">2021-02-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="致杨铭杰"><a href="#致杨铭杰" class="headerlink" title="致杨铭杰"></a>致杨铭杰</h1><p>本来是在家睡不着写年终总结来着，可是数着数着就到了年底，你就成了绕不过去的一颗石头。</p>
<p>我们的关系到现在还真的有点难讲，说朋友吧，也不合适，毕竟一般谁会睡朋友呢，说前任也不对，我们好像也从来没有在一起过。说来好笑，这让我想到了那年很土的一句“朋友以上，恋人未满”。</p>
<p>其实我们开始的是偶然也是必然，毕竟从一开始我就是带着目的来的嘛。以跟你打听健身卡续约为由加了个微信，到后来一起写检讨，那时候也不知道每天都在聊什么，每晚都三点多睡，不过那时候我是真的不知道你还有男朋友（我以为你已经分手了呢），再之后我们俩自欺欺人的安慰自己我们只是朋友间的聊天，没什么的，结果谁也没狠心踩住刹车。</p>
<p>那段时间其实还挺纠结的，我们都是一边享受着给彼此带来的快乐，一边承受着自己给自己施加的愧疚。元旦的时候我已经有些累了，又赶上朋友前段时间被查出中度抑郁，所以我就去上海看看朋友，顺便散散心，那时候其实我是想跟你说再见来着，结果在我睡醒一觉之后，你们分手了，不好意思，当时我笑出来了。那时候我就把愧疚什么的都丢了，那时候我就决定，活在当下就好了。以后的那段时间就真的挺开心的。</p>
<p>有时候我觉得你挺矫情的，或者说有点玛丽苏，你总是说着一些抽象的话剖析自己，真的很没有必要，因为一个人不是几句话就可以定义，一件事情的对错也不是非黑即白的。我和前女友分手这件事，就最后一根稻草来说，毫无疑问是她做错了，但是把时间线拉长，我或多或少也对促成这件事添了一把柴。所以不要轻易完全的否定自己，你挺好的，虽然很直，不粘人，也不爱回消息，甚至会有一些我无法理解的行为，但我还是挺喜欢的，说来可笑，居然有种初恋不会谈恋爱的感觉。</p>
<p>有件事情，我没有说谎，我对你第一次印象真的是因为你的名字，因为开学前我就在班级群里看了看同班同学的名字，所以我对大多数人的名字都有印象，之后上课点名点到杨铭杰的时候，我听到一女声，当时我立马就回头了，看到一个短发女孩，巧了，我的初恋也是短发，我也还喜欢短发。算是留下了颗种子吧。</p>
<p>因为疫情，莫名其妙的我们研二了，春天过去了，过季的种子也想发芽了。</p>
<p>李哲这人怎么说呢，虽然也谈过几段恋爱，但其实还是一个十分缺乏安全感的人，是有点害怕一个人突然消失了的感觉的，所以有时候杨铭杰一两个小时不回消息，他就有点慌，这么看来，他应该和女朋友每天在一起，其实是个适合结婚的人，但他还是个有点恐婚的人。朋友跟我说，每一个说自己不是Gay的男人，都是因为还没遇见那个他。可能每一个恐婚的人，也是因为没遇见那个人吧。说出来朋友们都会笑，其实他是一个内向的人，不善于跟陌生人打交道，也不善于觥筹交错，只是一头扎进自己喜欢的事情里两耳不闻，喜欢一个人喝酒，喜欢看着星星抽烟，喜欢在球场坐着，喜欢你。</p>
<p>杨铭杰说自己不喜欢发朋友圈，其实他也不怎么发朋友圈，但他就是想要出现你的朋友圈里，这样就不会再有这样的坏小子走到他们的身边。他们的不安全感其实来的合理却没有被好好解决，这是两个人的问题，但是他俩两个性格都有点倔，”你不做我凭什么做“，像极了小孩吵架。但与小孩吵架不同的是，杨铭杰吵架的时候也会阴阳怪气，在这点上，有点让李哲上火，讲道理和不讲道理李哲都不会上火，但是阴阳怪气可能会。所以他俩虽然也争执过，但最后都是以“我睡觉了，晚安“结尾，问题还是那些个问题，什么都没有变。我觉得或许他俩还是应该试着解决一下试试。</p>
<p>他不是个会说大话的人，他从来没有说过”我会永远爱你“、”我爱你一辈子“、”我会娶你回家“，他觉得这是没有意义的空话，虽然这些话确实可以让女生很安心、很有安全感，他认为只要过好在一起的每一天，之后所有事情都是顺其自然的。</p>
<p>所以，我喜欢你，在每一个今天和明天。</p>
<p>![image-20210209023721715](/Users/giotto/Library/Mobile Documents/27N4MQEA55<del>pro</del>writer/Documents/toYMJ/image-20210209023721715.png)</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/02/09/toYMJ/" data-id="ckua4t7hu001ivxgtguxpfpx2" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2020Report" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/31/2020Report/" class="article-date">
  <time class="dt-published" datetime="2020-12-31T09:13:42.109Z" itemprop="datePublished">2020-12-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="我的2020年终总结"><a href="#我的2020年终总结" class="headerlink" title="我的2020年终总结"></a>我的2020年终总结</h1><blockquote>
<p>我是旅途中的行人 </p>
<p>驻足于日落或是清晨</p>
</blockquote>
<p>这次总结写于2021年元旦凌晨五点半的上海，地点是在嘉定的一张沙发上。</p>
<p>2020年这一年对我来说，是我人生的第二个十二年，人们都说本命年会走背字，我这一年谈不上顺或者不顺，学习还是那样不上不下，生活也是那样不好不坏，朋友们也都还在，大家都健健康康的度过这多舛的2020。</p>
<p>这一年对很多人来说，都是被偷走的一年，有的人在家度过了自己的毕业季，有的人躺在沙发上把钱挣了，有的人申到了自己心仪的学校却只能网课，有的人走出家门开始了一边旅行一边工作的生活。对我来说亦是如此，这一年有大半的时间都在家度过，我爸说从某种程度上也感谢疫情，我才能在家这么长时间。</p>
<p>这一年匆匆而过，也不知道该写些什么，在家躺了半年多，每天的生活就是用各种方式打发时间。</p>
<img src="/Users/giotto/Library/Mobile Documents/27N4MQEA55~pro~writer/Documents/2020Report/IMG_8018.jpg" alt="IMG_8018" style="zoom:40%;" />



<p>一月，年三十的晚上，发小在高中校门口求婚，俨然在我们这群家伙中打响了结婚的第一枪，这一年身边的朋友也陆陆续续订婚、结婚，直到现在脑子有时还转不过来，原来我们已经到结婚的年龄了吗？</p>
<img src="/Users/giotto/Library/Mobile Documents/27N4MQEA55~pro~writer/Documents/2020Report/IMG_8323-2600071.jpg" alt="IMG_8323" style="zoom:20%;" />



<p>三月，春天到了，疫情终于开始有了变好的趋势，慢慢开始走出了家门。说来好笑，时隔一个月第一次下楼，腿都是软的，每一次出门都感觉自己是在做康复。也是在这个月，我完成了自己的第一个混剪，从一开始的毫无头绪，到后来的得心应手，可见相对于行不行，做不做显得更为重要。</p>
<img src="/Users/giotto/Library/Mobile Documents/27N4MQEA55~pro~writer/Documents/2020Report/img 2.jpg" alt="img 2" style="zoom:20%;" />



<p>四月，随着形势渐好，朋友们开始希冀着开学，学校要求我们每天上报自己的体温，填了一张又一张，总是给我们一种“快开学了“的错觉。五月会开学的吧，六月会开学的吧，七月、八月，九月总该开学了吧。那时候我怎么也不会想到这一个学期居然就这么在家里度过了。上一次这么想要开学，还是高考完的那个夏天，已经是六年前了。</p>
<img src="/Users/giotto/Library/Mobile Documents/27N4MQEA55~pro~writer/Documents/2020Report/img 3.jpg" alt="img 3" style="zoom:16%;" />



<p>五月，这应该是这半年我做的最有意义的一件事了，我拔掉了四颗智齿。最初的智齿应该是17年了，这两年时不时地就会提醒我一下“你还有颗牙支棱着呢”，所以趁着疫情，索性去拔掉算了。福无双至，祸不单行，一颗智齿变成了四颗，一颗都长不出来，我躺在椅子上，医生掰着我的嘴问我：”拔几个？“ 可能在家憋的太久的压力有些大，身体想要给自己找个刺激，脑子还没反应，嘴上却已经回答了”全拔啊”。然后五月紧接着六月，都是在拔牙和吐血中度过的。一定要保护好自己的牙齿。</p>
<img src="/Users/giotto/Library/Mobile Documents/27N4MQEA55~pro~writer/Documents/2020Report/image-20210210014108109.png" alt="image-20210210014108109" style="zoom:60%;" />



<p>到了七月，最大的感受就是这一年已经过半了，我们要开始走向2021年了。</p>
<img src="/Users/giotto/Library/Mobile Documents/27N4MQEA55~pro~writer/Documents/2020Report/img 4.jpg" alt="img 4" style="zoom:16%;" />



<p>八月对我来说是个新的开始，开始学习自洽，变得更加专注。回过头看自己走过的这几年，也还是充实的、开心的，像海边拾贝收集一个个新的爱好，做了一次又一次新的尝试，虽然大多失败了，但也不是一场徒然，永远不要忘记自己来自哪里，继续向前走就是了。</p>
<img src="/Users/giotto/Library/Mobile Documents/27N4MQEA55~pro~writer/Documents/2020Report/img 5.jpg" alt="img 5" style="zoom:16%;" />



<p>在九月，我们终于回到了学校，明明只是上了一个学期的课，现在我们却好像直接跳到了第二年。这是我所经历的最长的一次停课，上一次停课还是初中那时，下了一场大雪埋了路，休息了三天。</p>
<img src="/Users/giotto/Library/Mobile Documents/27N4MQEA55~pro~writer/Documents/2020Report/img 7-3147518.jpg" alt="img 7" style="zoom:22%;" />



<p>整个十月生活都很规律，每天总会有一个多小时的时间运动，体重也从150回到了140，身体机能也从抖着腿下楼恢复到了疫情前的 “毫无训练痕迹”。我是一个极易产生行为惯性的人，所以也就很容易形成生活规律，有时候可以十天半个月不出门，有时候也可以每天锻炼直到浑身“残废”。有时候打破这种行为惯性，会让我潜意识的感觉到不适，貌似只是简单的遵从这种行为就可以让我享受来自多巴胺的快乐。</p>
<img src="/Users/giotto/Library/Mobile Documents/27N4MQEA55~pro~writer/Documents/2020Report/img 6.jpg" alt="img 6" style="zoom:16%;" />



<p>十一月重读了《人月神话》，Brooks对于在软件工程中“没有银弹”的预言显然已经应验，十年过去了，软件工程的生产效率依旧没有应该数量级上的提高。其称系统开发是一座焦油坑，或大或小的系统看似都可以顺利运行，其中单独出现的一些问题也都可以被解决，但是当他们相互纠缠和累积在一起的时候，团队的行为就会变得越来越慢，仿佛史前巨兽在焦油坑内的垂死挣扎。</p>
<img src="/Users/giotto/Library/Mobile Documents/27N4MQEA55~pro~writer/Documents/2020Report/2020-12-31 235741.jpg" alt="2020-12-31 235741" style="zoom:40%;" />



<p>十二月，这魔幻的一年真的就要过去了，这个月开始有些焦虑，焦虑的原因是这一年过的十分囫囵，回头想想也没有什么可以被记录的，或者说值得被记录的，也仅仅是我自己知道就够了。所以为了给这一年认真的结个尾，并维系一下与大学同学的感情，我决定去上海跨年，当时也不知道去做什么，去哪跨年，直到启程前两天才决定去看史炎老师的脱口秀。说到史炎，还真有那么三分童年的味道，那时候我还在上初中，东方卫视有个节目叫《今晚80后脱口秀》，刚开始演员只有一个嘴里含着枣的王自健，他有三个活在段子里的好朋友，蛋蛋、建国和赖宝，赖宝在今年离开了这个世界，其余两个如今风生水起。后来史炎作为常驻Cast每次都会表演一个十分钟的脱口秀，因为表情、肢体语言丰富，以及夜以继日的重复自己毕业于上海交大的梗，所以我对他印象十分深刻。现在除了线下和商演，应该也很难再看到史炎的演出了吧。</p>
<p>这一年其实本该是轻松的一年才对，因为明年又要为工作重拾课本开始学习了，研究生的摸鱼阶段结束了，要为迈入下一阶段提前做些准备了。幸运的是，到目前为止编程带给我的更多的还是乐趣，这种快乐来自于凭空创造事物而产生的成就感，Brooks称这种快乐是“上帝创造世界的折射”，是一种呈现在每片独特的、崭新的树叶和雪花上的喜悦。每一行代码都是自己的创作，这些代码以特定的顺序啮合在一起，以一种美妙的方式运行起来，从而实现不同的功能，这些功能直接或间接的帮助到别人，甚至被越来越多的人接受，这带给作者的快乐是无法形容的，或许这也是开源的魅力吧。“编程的快乐在于它不仅满足了我们内心深处进行创造的渴望，而且还唤醒了每个人内心的情感。”</p>
<p>2020无论如何也不能称为平凡的一年，这一年发生了太多不平凡的事，但它对于大多数人来说又是极为平凡的一年，我们日复一日做着最平凡的事，活着，或者渴望活着。生命从未拥有如此这般强烈的存在感，每天都有人离去，他们中的大多数还没有做好准备与这个世界告别，却被意外扼住了喉咙。</p>
<p>其实我是很怕死的，记得之前有个朋友问我 “你梦想活到多少岁？”，我说：“我想不死。”</p>
<p>因为我对现在的生活很满意，有希望也有烦恼，比例刚刚好；因为身边这群朋友让我感到快乐，没有感觉到孤单；因为我没有什么后悔的事情，我一直活在今天；因为我不知道有没有轮回，我不想再回去高考了；因为，我爱这个世界。</p>
<blockquote>
<p>我对自己的要求很低：我活在世上，无非想要明白些道理，遇见些有趣的事。倘能如我愿，我的一生就算成功的。</p>
</blockquote>
<p>最后，是例行这一年里拍过最喜欢的八张照片。</p>
<img src="/Users/giotto/Library/Mobile Documents/27N4MQEA55~pro~writer/Documents/2020Report/image-20210213004833857.png" alt="image-20210213004833857" style="zoom:45%;" />



<img src="/Users/giotto/Library/Mobile Documents/27N4MQEA55~pro~writer/Documents/2020Report/img 8.jpg" alt="img 8" style="zoom:22.5%;" />



<img src="/Users/giotto/Library/Mobile Documents/27N4MQEA55~pro~writer/Documents/2020Report/img 9.jpg" alt="img 9" style="zoom:16.3%;" />



<img src="/Users/giotto/Library/Mobile Documents/27N4MQEA55~pro~writer/Documents/2020Report/img 10.jpg" alt="img 10" style="zoom:16.3%;" />



<img src="/Users/giotto/Library/Mobile Documents/27N4MQEA55~pro~writer/Documents/2020Report/img 11.jpg" alt="img 11" style="zoom:16.3%;" />



<img src="/Users/giotto/Library/Mobile Documents/27N4MQEA55~pro~writer/Documents/2020Report/img 12.jpg" alt="img 12" style="zoom:16.3%;" />



<img src="/Users/giotto/Library/Mobile Documents/27N4MQEA55~pro~writer/Documents/2020Report/IMG_6797.jpg" alt="IMG_6797" style="zoom:22%;" />



<img src="/Users/giotto/Library/Mobile Documents/27N4MQEA55~pro~writer/Documents/2020Report/IMG_6964.jpg" alt="IMG_6964" style="zoom:22%;" />



<p><strong>活着的意义，就是在你快死的瞬间划过你脑海的那些事啊。</strong></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/12/31/2020Report/" data-id="ckua4t7hb0005vxgtggqibcis" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-vuex_DOC" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/17/vuex_DOC/" class="article-date">
  <time class="dt-published" datetime="2020-12-17T11:23:49.000Z" itemprop="datePublished">2020-12-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="Extract"><a href="#Extract" class="headerlink" title="Extract"></a>Extract</h2><p>试想当我们在开发一个Vue应用程序时，如果在一个项目中频繁的使用组件传参的方式来同步data中的值，一旦项目结构变得复杂，管理和维护这些数据将变得十分繁琐，为此，Vue为这些被多个组件共同使用的data提供了一个统一的管理工具—Vuex。</p>
<p>Vuex是专为Vue.js应用程序开发的状态管理模式，集中存储管理应用的所有组件的状态（数据），并以相同的规则保证状态以一种可预测的方式发生变化。</p>
<h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>可在项目目录下直接通过<code>npm</code>安装，其他安装方式详见<a target="_blank" rel="noopener" href="https://vuex.vuejs.org/zh/installation.html">Vuex安装</a>。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vuex --save</span><br></pre></td></tr></table></figure>



<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>首先需要创建一个<code>store</code>实例，引入你创建的所有<code>modules</code>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">目录结构</span><br><span class="line">/src</span><br><span class="line">｜-main.js</span><br><span class="line">｜-/store</span><br><span class="line">	｜-/modules</span><br><span class="line">	｜-index.js</span><br></pre></td></tr></table></figure>



<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js</span></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"><span class="keyword">import</span> user <span class="keyword">from</span> <span class="string">&#x27;./modules/user&#x27;</span></span><br><span class="line"><span class="keyword">import</span> team <span class="keyword">from</span> <span class="string">&#x27;./modules/team&#x27;</span></span><br><span class="line"><span class="keyword">import</span> product <span class="keyword">from</span> <span class="string">&quot;./modules/product&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> chat <span class="keyword">from</span> <span class="string">&quot;./modules/chat&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> notification <span class="keyword">from</span> <span class="string">&quot;./modules/notification&quot;</span>;</span><br><span class="line"></span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">    <span class="attr">modules</span>: &#123;</span><br><span class="line">        user,team,product,chat,notification</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">strict</span>: <span class="literal">true</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<p>在<code>main.js</code>中，引入<code>store</code>实例并暴露出来：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./store&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  <span class="attr">render</span>: <span class="function"><span class="params">h</span> =&gt;</span> h(App),</span><br><span class="line">  store</span><br><span class="line">&#125;).$mount(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h2 id="State"><a href="#State" class="headerlink" title="State"></a>State</h2><p>State是Vuex的基本属性，称为单一状态树，如果熟悉Java面向对象编程的话，我们可以将其类比为成员变量：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="comment">//成员变量</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String gender;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Users</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;User&gt; users;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> state = <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    <span class="comment">//State</span></span><br><span class="line">    <span class="attr">users</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">    		<span class="attr">name</span>: ...,</span><br><span class="line">    		<span class="attr">age</span>: ...,</span><br><span class="line">    		<span class="attr">gender</span>: ...,        </span><br><span class="line">        &#125;,</span><br><span class="line">        ...</span><br><span class="line">        ...</span><br><span class="line">        ...</span><br><span class="line">    ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>



<p>在Vue组件中获得Vuex状态可通过以下两种方式：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//方法一：在根实例中注册store选项，该实例会注入到根组件下的所有子组件中</span></span><br><span class="line"><span class="built_in">this</span>.$store.state.name</span><br><span class="line"></span><br><span class="line"><span class="comment">//方法二：使用mapState辅助函数</span></span><br><span class="line"><span class="keyword">import</span> &#123; mapState &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="attr">computed</span>: mapState(&#123;</span><br><span class="line">    <span class="comment">// 箭头函数可使代码更简练</span></span><br><span class="line">    <span class="attr">count</span>: <span class="function"><span class="params">state</span> =&gt;</span> state.count,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 传字符串参数 &#x27;count&#x27; 等同于 `state =&gt; state.count`</span></span><br><span class="line">    <span class="attr">countAlias</span>: <span class="string">&#x27;count&#x27;</span>,</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 为了能够使用 `this` 获取局部状态，必须使用常规函数</span></span><br><span class="line">    countPlusLocalState (state) &#123;</span><br><span class="line">      <span class="keyword">return</span> state.count + <span class="built_in">this</span>.localCount</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Getter"><a href="#Getter" class="headerlink" title="Getter"></a>Getter</h2><p><code>getter</code>的使用可类比为Java中的<code>get</code>方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="comment">//成员变量</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String gender;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Users</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;User&gt; users;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">//get方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">getUsers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> users;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//State</span></span><br><span class="line"><span class="keyword">const</span> state = <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">users</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">    		<span class="attr">name</span>: ...,</span><br><span class="line">    		<span class="attr">age</span>: ...,</span><br><span class="line">    		<span class="attr">gender</span>: ...,        </span><br><span class="line">        &#125;,</span><br><span class="line">        ...</span><br><span class="line">        ...</span><br><span class="line">        ...</span><br><span class="line">    ]</span><br><span class="line">&#125;)</span><br><span class="line">    </span><br><span class="line"><span class="comment">//getter</span></span><br><span class="line"><span class="keyword">const</span> getters = &#123;</span><br><span class="line">    <span class="attr">users</span>: <span class="function"><span class="params">state</span> =&gt;</span> state.users,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>如果仅仅如此，为何不直接获取<code>state</code>呢？因为有时候我们需要从<code>state</code>中派生出一些状态，例如对列表进行过滤，同样我们可与Java实现类比：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="comment">//成员变量</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String gender;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Users</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;User&gt; users;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">//get方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">getUsers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> users;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//返回18岁及以下用户对象</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">getChildren</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;User&gt; children = <span class="keyword">new</span> ArrayList&lt;&gt;;</span><br><span class="line">        <span class="keyword">for</span> (User item: <span class="keyword">this</span>.users) &#123;</span><br><span class="line">            <span class="keyword">if</span> (item.age &lt;= <span class="number">18</span>) &#123;</span><br><span class="line">                children.add(item)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> children;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//State</span></span><br><span class="line"><span class="keyword">const</span> state = <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">users</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">    		<span class="attr">name</span>: ...,</span><br><span class="line">    		<span class="attr">age</span>: ...,</span><br><span class="line">    		<span class="attr">gender</span>: ...,        </span><br><span class="line">        &#125;,</span><br><span class="line">        ...</span><br><span class="line">        ...</span><br><span class="line">        ...</span><br><span class="line">    ]</span><br><span class="line">&#125;)</span><br><span class="line">    </span><br><span class="line"><span class="comment">//getter</span></span><br><span class="line"><span class="keyword">const</span> getters = &#123;</span><br><span class="line">    <span class="attr">users</span>: <span class="function"><span class="params">state</span> =&gt;</span> state.users,</span><br><span class="line">    <span class="comment">//返回18岁及以下用户对象</span></span><br><span class="line">    <span class="attr">children</span>: <span class="function"><span class="params">state</span> =&gt;</span> state.users,filter(</span><br><span class="line">    	<span class="function"><span class="params">user</span> =&gt;</span> user.age &lt;= <span class="number">18</span>),</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>在Vue组件中我们可以通过属性访问或者通过<code>mapGetters</code>来获取对象：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapGetters &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">        <span class="attr">computed</span>: &#123;</span><br><span class="line">            ...mapGetters([</span><br><span class="line">                <span class="string">&#x27;users&#x27;</span>,</span><br><span class="line">            ]),</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">methods</span>: &#123;</span><br><span class="line">            <span class="function"><span class="title">printUsers</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">                <span class="comment">//通过mapGetters访问</span></span><br><span class="line">                <span class="built_in">console</span>.log(<span class="built_in">this</span>.users)</span><br><span class="line">                <span class="comment">//通过属性访问</span></span><br><span class="line">                <span class="built_in">console</span>.log(<span class="built_in">this</span>.$store.getters.users)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>



<h2 id="Mutation"><a href="#Mutation" class="headerlink" title="Mutation"></a>Mutation</h2><p>提交<code>mutation</code>是更改Vuex的<code>store</code>中状态的唯一方法，Vuex中的<code>mutation</code>类似于事件：每个<code>mutation</code>都有一个字符串的事件类型（type）和一个回调函数（handler）。这个回调函数就是我们实际进行状态更改的方法，并且他会接受<code>state</code>作为第一个参数。</p>
<p><code>mutation</code>的实际使用类似于Java中的<code>set</code>方法，是设置<code>state</code>值的唯一方式。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="comment">//成员变量</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String gender;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Users</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;User&gt; users;</span><br><span class="line">    <span class="keyword">private</span> Boolean status;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">//set方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStatus</span><span class="params">()</span> </span>&#123;</span><br><span class="line">     	<span class="keyword">this</span>.status = <span class="keyword">true</span>;  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//State</span></span><br><span class="line"><span class="keyword">const</span> state = <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">users</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">    		<span class="attr">name</span>: ...,</span><br><span class="line">    		<span class="attr">age</span>: ...,</span><br><span class="line">    		<span class="attr">gender</span>: ...,        </span><br><span class="line">        &#125;,</span><br><span class="line">        ...</span><br><span class="line">        ...</span><br><span class="line">        ...</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">status</span>: <span class="literal">null</span>,</span><br><span class="line">&#125;)</span><br><span class="line">    </span><br><span class="line"><span class="comment">//mutation</span></span><br><span class="line"><span class="keyword">const</span> mutations = &#123;</span><br><span class="line">    <span class="function"><span class="title">setStatus</span>(<span class="params">state</span>)</span> &#123;</span><br><span class="line">        state.status = <span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>但不同于Java中<code>set</code>的使用方式，我们不能直接调用一个<code>mutation handler</code>，而是提交一个名为<code>xxx</code>的<code>mutation</code>，触发相应的<code>mutation handler</code>执行具体的变更。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Users users = <span class="keyword">new</span> Users();</span><br><span class="line">users.setStatus();</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.$store.commit(<span class="string">&quot;setStatus&quot;</span>)</span><br></pre></td></tr></table></figure>



<p>在Java中<code>set</code>函数可以传入参数进而变更成员变量。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="comment">//成员变量</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String gender;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Users</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;User&gt; users;</span><br><span class="line">    <span class="keyword">private</span> Boolean status;</span><br><span class="line">	</span><br><span class="line">    <span class="comment">//set方法</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStatus</span><span class="params">()</span> </span>&#123;</span><br><span class="line">     	<span class="keyword">this</span>.status = <span class="keyword">true</span>;  </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUser</span><span class="params">(User user)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.users.add(user);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>调用<code>set</code>函数：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Users users = <span class="keyword">new</span> Users();</span><br><span class="line">users.setUser(newUser);</span><br></pre></td></tr></table></figure>



<p>在Vuex中我们也可以通过提交载荷（Payload）的方式向<code>store.commit</code>传入额外的参数，即<code>mutation</code>的载荷。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//State</span></span><br><span class="line"><span class="keyword">const</span> state = <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">users</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">    		<span class="attr">name</span>: ...,</span><br><span class="line">    		<span class="attr">age</span>: ...,</span><br><span class="line">    		<span class="attr">gender</span>: ...,        </span><br><span class="line">        &#125;,</span><br><span class="line">        ...</span><br><span class="line">        ...</span><br><span class="line">        ...</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">status</span>: <span class="literal">null</span>,</span><br><span class="line">&#125;)</span><br><span class="line">    </span><br><span class="line"><span class="comment">//mutation</span></span><br><span class="line"><span class="keyword">const</span> mutations = &#123;</span><br><span class="line">    <span class="function"><span class="title">setStatus</span>(<span class="params">state</span>)</span> &#123;</span><br><span class="line">        state.status = <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">setUser</span>(<span class="params">state, user</span>)</span> &#123;</span><br><span class="line">        state.users.push(user)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>在组件中提交携带载荷的<code>mutation</code>：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.$store.commit(<span class="string">&#x27;setUser&#x27;</span>, user)</span><br></pre></td></tr></table></figure>



<p>或者使用<code>mapMutations</code>映射出来：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapMutations &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    ...mapMutations([</span><br><span class="line">      <span class="string">&#x27;setUser&#x27;</span>,</span><br><span class="line">    ]),</span><br><span class="line">      <span class="function"><span class="title">appendUser</span>(<span class="params">user</span>)</span>&#123;</span><br><span class="line">          <span class="built_in">this</span>.setUser(user)</span><br><span class="line">      &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>综上看来，<code>mutation</code>的使用与<code>set</code>函数的目的是相同，但<code>mutation</code>在使用中最大的原则 — 必须是同步函数。</p>
<p>在<code>mutation</code>中混合异步调用会导致你的程序很难调试，当我们调用了两个包含异步回调的<code>mutation</code>来改变状态，我们无法知道什么时候回调以及哪个先回调，因此在Vuex中，<strong>mutation都是同步事务</strong>。</p>
<p>所以为了处理异步操作，Vuex引入了<code>action</code>这一概念。</p>
<h2 id="Action"><a href="#Action" class="headerlink" title="Action"></a>Action</h2><p><code>action</code>类似于<code>mutation</code>是可“调用”的方法，两者不同点在于：</p>
<ul>
<li><code>action</code>提交<code>mutation</code>，而不直接变更状态；</li>
<li><strong><code>action</code>可以包含任意异步操作</strong>。</li>
</ul>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//State</span></span><br><span class="line"><span class="keyword">const</span> state = <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">users</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">    		<span class="attr">name</span>: ...,</span><br><span class="line">    		<span class="attr">age</span>: ...,</span><br><span class="line">    		<span class="attr">gender</span>: ...,        </span><br><span class="line">        &#125;,</span><br><span class="line">        ...</span><br><span class="line">        ...</span><br><span class="line">        ...</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">status</span>: <span class="literal">null</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//action</span></span><br><span class="line"><span class="keyword">const</span> actions = &#123;</span><br><span class="line">    <span class="function"><span class="title">updateUser</span>(<span class="params">&#123;commit&#125;</span>)</span> &#123;</span><br><span class="line">		request(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&#x27;/user/getNewUser&#x27;</span></span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span></span><br><span class="line">        &#125;).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">            commit(<span class="string">&#x27;setUser&#x27;</span>, res.data)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="comment">//mutation</span></span><br><span class="line"><span class="keyword">const</span> mutations = &#123;</span><br><span class="line">    <span class="function"><span class="title">setStatus</span>(<span class="params">state</span>)</span> &#123;</span><br><span class="line">        state.status = <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">setUser</span>(<span class="params">state, user</span>)</span> &#123;</span><br><span class="line">        state.users.push(user)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>这段代码中我们注册了一个简单的异步<code>action</code>，我们通过<code>request</code>向后端发送请求，请求新用户，然后我们在回调函数中提交<code>mutation</code>变更状态。</p>
<p><code>action</code>通过<code>store.dispatch</code>触发：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.$store.dispatch(<span class="string">&#x27;updateUser&#x27;</span>)</span><br></pre></td></tr></table></figure>



<p><code>action</code>同样可以通过提交载荷的方式进行分发：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//State</span></span><br><span class="line"><span class="keyword">const</span> state = <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">users</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">    		<span class="attr">name</span>: ...,</span><br><span class="line">    		<span class="attr">age</span>: ...,</span><br><span class="line">    		<span class="attr">gender</span>: ...,        </span><br><span class="line">        &#125;,</span><br><span class="line">        ...</span><br><span class="line">        ...</span><br><span class="line">        ...</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">status</span>: <span class="literal">null</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//action</span></span><br><span class="line"><span class="keyword">const</span> actions = &#123;</span><br><span class="line">	<span class="function"><span class="title">appendUser</span>(<span class="params">&#123;commit&#125;, user</span>)</span> &#123;</span><br><span class="line">        commit(<span class="string">&#x27;setUser&#x27;</span>, user)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="comment">//mutation</span></span><br><span class="line"><span class="keyword">const</span> mutations = &#123;</span><br><span class="line">    <span class="function"><span class="title">setStatus</span>(<span class="params">state</span>)</span> &#123;</span><br><span class="line">        state.status = <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">setUser</span>(<span class="params">state, user</span>)</span> &#123;</span><br><span class="line">        state.users.push(user)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">this</span>.$store.dispatch(<span class="string">&#x27;appendUser&#x27;</span>, newUser)</span><br></pre></td></tr></table></figure>



<p>或者使用<code>mapAction</code>映射出来：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; mapActions &#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    ...mapActions([</span><br><span class="line">      <span class="string">&#x27;appendUser&#x27;</span>,</span><br><span class="line">    ]),</span><br><span class="line">      </span><br><span class="line">      <span class="function"><span class="title">test</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">          <span class="built_in">this</span>.appendUser(user)</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="Module"><a href="#Module" class="headerlink" title="Module"></a>Module</h2><p>使用单一状态树，应用的所有状态都会集中到一个较大的对象，随着应用迭代变得越来越复杂，<code>store</code>对象会变得越来越臃肿。为了解决以上问题，Vuex允许我们将对象模块（Module）化，每个模块拥有自己的<code>state</code>、<code>mutation</code>、<code>action</code>、<code>getter</code>甚至嵌套子模块。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> moduleA = &#123;</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> (&#123; ... &#125;),</span><br><span class="line">  <span class="attr">mutations</span>: &#123; ... &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123; ... &#125;,</span><br><span class="line">  <span class="attr">getters</span>: &#123; ... &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> moduleB = &#123;</span><br><span class="line">  <span class="attr">state</span>: <span class="function">() =&gt;</span> (&#123; ... &#125;),</span><br><span class="line">  <span class="attr">mutations</span>: &#123; ... &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123; ... &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  <span class="attr">modules</span>: &#123;</span><br><span class="line">    <span class="attr">a</span>: moduleA,</span><br><span class="line">    <span class="attr">b</span>: moduleB</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">store.state.a <span class="comment">// -&gt; moduleA 的状态</span></span><br><span class="line">store.state.b <span class="comment">// -&gt; moduleB 的状态</span></span><br></pre></td></tr></table></figure>



<p>在默认情况下，模块内部的<code>action</code>、<code>mutation</code>和<code>getter</code>是注册在全局命名空间的，这样使得多个模块能够对同一<code>mutation</code>或<code>action</code>作出响应。</p>
<p>如果你希望你的模块具有更高的封装度和复用性，可以通过添加``namespaces: true`的方式使其成为带命名空间的模块。</p>
<p>下面我们重新复习下Vuex的目录结构：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">目录结构</span><br><span class="line">/src</span><br><span class="line">｜-main.js</span><br><span class="line">｜-/store</span><br><span class="line">	｜-/modules</span><br><span class="line">		|-user.js</span><br><span class="line">		|-team.js</span><br><span class="line">		|-product.js</span><br><span class="line">		|-chat.js</span><br><span class="line">		|-notification.js</span><br><span class="line">	｜-index.js</span><br></pre></td></tr></table></figure>



<p>以<code>user.js</code>为例，让我们看一下一个完整的Module是怎样的。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//user.js</span></span><br><span class="line"><span class="keyword">import</span> &#123;request&#125; <span class="keyword">from</span> <span class="string">&#x27;../../lib/network/request&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//State</span></span><br><span class="line"><span class="keyword">const</span> state = <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">users</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">    		<span class="attr">name</span>: ...,</span><br><span class="line">    		<span class="attr">age</span>: ...,</span><br><span class="line">    		<span class="attr">gender</span>: ...,        </span><br><span class="line">        &#125;,</span><br><span class="line">        ...</span><br><span class="line">        ...</span><br><span class="line">        ...</span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">status</span>: <span class="literal">null</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//action</span></span><br><span class="line"><span class="keyword">const</span> actions = &#123;</span><br><span class="line">    <span class="function"><span class="title">updateUser</span>(<span class="params">&#123;commit&#125;</span>)</span> &#123;</span><br><span class="line">		request(&#123;</span><br><span class="line">            <span class="attr">url</span>: <span class="string">&#x27;/user/getNewUser&#x27;</span></span><br><span class="line">            <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span></span><br><span class="line">        &#125;).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">            commit(<span class="string">&#x27;setUser&#x27;</span>, res.data)</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//getter</span></span><br><span class="line"><span class="keyword">const</span> getters = &#123;</span><br><span class="line">    <span class="attr">users</span>: <span class="function"><span class="params">state</span> =&gt;</span> state.users,</span><br><span class="line">    <span class="comment">//返回18岁及以下用户对象</span></span><br><span class="line">    <span class="attr">children</span>: <span class="function"><span class="params">state</span> =&gt;</span> state.users,filter(</span><br><span class="line">    	<span class="function"><span class="params">user</span> =&gt;</span> user.age &lt;= <span class="number">18</span>),</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="comment">//mutation</span></span><br><span class="line"><span class="keyword">const</span> mutations = &#123;</span><br><span class="line">    <span class="function"><span class="title">setStatus</span>(<span class="params">state</span>)</span> &#123;</span><br><span class="line">        state.status = <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="function"><span class="title">setUser</span>(<span class="params">state, user</span>)</span> &#123;</span><br><span class="line">        state.users.push(user)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    state,</span><br><span class="line">    getters,</span><br><span class="line">    actions,</span><br><span class="line">    mutations</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>然后需要在<code>/modules</code>目录下的<code>index.js</code>中将各个<code>module</code>注册到<code>store</code>对象中：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.js</span></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"><span class="keyword">import</span> user <span class="keyword">from</span> <span class="string">&#x27;./modules/user&#x27;</span></span><br><span class="line"><span class="keyword">import</span> team <span class="keyword">from</span> <span class="string">&#x27;./modules/team&#x27;</span></span><br><span class="line"><span class="keyword">import</span> product <span class="keyword">from</span> <span class="string">&quot;./modules/product&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> chat <span class="keyword">from</span> <span class="string">&quot;./modules/chat&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> notification <span class="keyword">from</span> <span class="string">&quot;./modules/notification&quot;</span>;</span><br><span class="line"></span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">    <span class="attr">modules</span>: &#123;</span><br><span class="line">        user,team,product,chat,notification</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//严格模式：无论何时发生了状态变更且不是由 mutation 函数引起的，将会抛出错误。这能保证所有的状态变更都能被调试工具跟踪到。</span></span><br><span class="line">    <span class="attr">strict</span>: <span class="literal">true</span></span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p>然后在<code>main.js</code>中将<code>store</code>放进我们的Vue应用程序中：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//main.js</span></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./store&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">  <span class="attr">render</span>: <span class="function"><span class="params">h</span> =&gt;</span> h(App),</span><br><span class="line">  store</span><br><span class="line">&#125;).$mount(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>



<p>至此，这便是一个完整的Vuex的使用实例，虽然在Vue中我们也可以通过属性传递的方式在不同组件之间传递data，但是当同一个data需要被多个组件同时调用，数据的一致性便很难保证，Vuex的引入则很好的解决了这一问题，Vuex中状态的变化是全局的，是实时计算的，当我们<code>getter</code>的计算依托于多个<code>state</code>时，当我们提交了新的<code>commit</code>变更状态，相应的<code>getter</code>返回值也会变化，这让我们不用过多分心于数据的一致性。</p>
<p>Vuex可以帮助我们管理共享状态，在应用并不复杂的情况下使用Vuex可能会有些多余，但是当构建一个复杂应用程序时，Vuex对于管理共享状态会是一个很好的选择。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/12/17/vuex_DOC/" data-id="ckua4t7i50036vxgt594y5qwu" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-LogMonitor" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/10/01/LogMonitor/" class="article-date">
  <time class="dt-published" datetime="2020-10-01T07:24:35.000Z" itemprop="datePublished">2020-10-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="用户行为日志监控数据可视化"><a href="#用户行为日志监控数据可视化" class="headerlink" title="用户行为日志监控数据可视化"></a>用户行为日志监控数据可视化</h1><h2 id="前端"><a href="#前端" class="headerlink" title="前端"></a>前端</h2><ol>
<li>Vue；</li>
<li>Echarts。</li>
</ol>
<h2 id="后端"><a href="#后端" class="headerlink" title="后端"></a>后端</h2><p>语言： Python；</p>
<p>库： pymongo、pyecharts、Flask</p>
<h2 id="实现方式"><a href="#实现方式" class="headerlink" title="实现方式"></a>实现方式</h2><p>前端对后端发送请求，然后后端获取存储的日志信息，对日志进行的解析。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取日志创建日期</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getDateLog</span>():</span></span><br><span class="line">    data = db.getDateLog()</span><br><span class="line">    dataList = <span class="built_in">list</span>()</span><br><span class="line">    <span class="built_in">print</span>(data)</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> data:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">type</span>(item[<span class="string">&#x27;date&#x27;</span>]) == <span class="built_in">str</span>:</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                item[<span class="string">&#x27;date&#x27;</span>] = datetime.datetime.strptime(</span><br><span class="line">                    item[<span class="string">&#x27;date&#x27;</span>],</span><br><span class="line">                    <span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)</span><br><span class="line">            <span class="keyword">except</span> ValueError:</span><br><span class="line">                item[<span class="string">&#x27;date&#x27;</span>] = datetime.datetime.strptime(</span><br><span class="line">                    item[<span class="string">&#x27;date&#x27;</span>],</span><br><span class="line">                    <span class="string">&quot;%m/%d/%Y, %I:%M:%S %p&quot;</span></span><br><span class="line">                )</span><br><span class="line">        dataList.append(item)</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> dataList:</span><br><span class="line">        item[<span class="string">&#x27;date&#x27;</span>] = (item[<span class="string">&#x27;date&#x27;</span>] + datetime.timedelta(hours=<span class="number">8</span>))</span><br><span class="line">    <span class="keyword">return</span> dataList</span><br></pre></td></tr></table></figure>





<p>将有效数据封装成echarts对象，返回给前端。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@user_bp.route(<span class="params"><span class="string">&#x27;/logHeatMap&#x27;</span></span>)</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getLogHeatMap</span>():</span></span><br><span class="line">    value = [[<span class="number">0</span>] * <span class="number">7</span> <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">24</span>)]</span><br><span class="line">    data = UserService.getDateLog()</span><br><span class="line">    mapData = []</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> data:</span><br><span class="line">        i = value[item[<span class="string">&#x27;date&#x27;</span>].hour][item[<span class="string">&#x27;date&#x27;</span>].weekday()]</span><br><span class="line">        value[item[<span class="string">&#x27;date&#x27;</span>].hour][item[<span class="string">&#x27;date&#x27;</span>].weekday()] = i + <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">24</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">            mapData.append([i, j, value[i][j]])</span><br><span class="line">    heatMap = (</span><br><span class="line">        HeatMap()</span><br><span class="line">        .add_xaxis(Faker.clock)</span><br><span class="line">        .add_yaxis(<span class="string">&quot;Action&quot;</span>, Faker.week, mapData)</span><br><span class="line">        .set_global_opts(</span><br><span class="line">            visualmap_opts=options.VisualMapOpts(</span><br><span class="line">                max_=<span class="number">3000</span>, min_=<span class="number">100</span></span><br><span class="line">            )</span><br><span class="line">        )</span><br><span class="line">    )</span><br><span class="line">    <span class="keyword">return</span> heatMap.dump_options_with_quotes()</span><br></pre></td></tr></table></figure>





<p>前端使用``Echarts`对数据进行解析，渲染数据可视化图表。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;map&quot;</span></span></span><br><span class="line"><span class="tag">         <span class="attr">:style</span>=<span class="string">&quot;&#123;width: &#x27;1200px&#x27;, height: &#x27;600px&#x27;&#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">import</span> &#123;request&#125; <span class="keyword">from</span> <span class="string">&quot;@/lib/network/request&quot;</span>;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="javascript">        <span class="attr">name</span>: <span class="string">&quot;ActionLogHeatMap&quot;</span>,</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">data</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="javascript">            &#125;</span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">computed</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">created</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">this</span>.getChart()</span></span><br><span class="line"><span class="javascript">        &#125;,</span></span><br><span class="line"><span class="javascript">        <span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="javascript">            <span class="function"><span class="title">getChart</span>(<span class="params"></span>)</span> &#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">let</span> map = <span class="built_in">this</span>.$echarts.init(<span class="built_in">document</span>.getElementById(<span class="string">&#x27;map&#x27;</span>))</span></span><br><span class="line"><span class="javascript">                request(&#123;</span></span><br><span class="line"><span class="javascript">                    <span class="attr">url</span>: <span class="string">&#x27;/api/user/logHeatMap&#x27;</span>,</span></span><br><span class="line"><span class="javascript">                    <span class="attr">method</span>: <span class="string">&#x27;get&#x27;</span></span></span><br><span class="line"><span class="javascript">                &#125;).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">                    map.setOption(res.data)</span></span><br><span class="line"><span class="javascript">                &#125;)</span></span><br><span class="line"><span class="javascript">            &#125;,</span></span><br><span class="line"><span class="javascript">        &#125;</span></span><br><span class="line"><span class="javascript">    &#125;</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="图表"><a href="#图表" class="headerlink" title="图表"></a>图表</h2><h3 id="用户行为日志可视化"><a href="#用户行为日志可视化" class="headerlink" title="用户行为日志可视化"></a>用户行为日志可视化</h3><p>![用户行为日志](/Users/giotto/Library/Mobile Documents/27N4MQEA55<del>pro</del>writer/Documents/Untitled/image-20201001105904156.png)</p>
<p>对日志按照创建日期进行解析可知，用户行为主要发生在上午``9:00 - 11:00<code>以及下午</code>1:00 - 5:00`，并在周一至周五存在一定的加班情况，周天较为空闲。</p>
<p>此处用户行为并没有区别<code>action</code>的类别，如果去除掉<code>open action·</code>，视图会更接近于<code>github</code>的提交热度图。</p>
<p>![gitee贡献度视图](/Users/giotto/Library/Mobile Documents/27N4MQEA55<del>pro</del>writer/Documents/Untitled/image-20201001110807658.png)</p>
<h3 id="Project-amp-Task旭日图"><a href="#Project-amp-Task旭日图" class="headerlink" title="Project&amp;Task旭日图"></a>Project&amp;Task旭日图</h3><p>将日志根据Project以及Task进行划分，展示Project以及Task的提交热度数据，考虑到数据量庞大，可追加时间以及Top10 Project的限制。</p>
<p>即便如此，在构造Echarts对象时，依旧出现了频繁查询数据库导致的程序运行缓慢，考虑可使用索引的方式，加快查询速度。</p>
<p>![旭日图](/Users/giotto/Library/Mobile Documents/27N4MQEA55<del>pro</del>writer/Documents/Untitled/image-20201001112139407.png)</p>
<h3 id="Project河流图"><a href="#Project河流图" class="headerlink" title="Project河流图"></a>Project河流图</h3><p>单个Project中的多个Task在同一时间段可能是并行推进，河流图可以展示在某一时间段，各个Task提交或保存Action的次数，从而推算每一个Task从开始到结束大致平均需要的时间，帮助管理者制定合适的Deadline。</p>
<p>![河流图实例](/Users/giotto/Library/Mobile Documents/27N4MQEA55<del>pro</del>writer/Documents/Untitled/image-20201001145857444.png)</p>
<p>​    </p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/10/01/LogMonitor/" data-id="ckua4t7hn0013vxgt8j5c3nq7" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-K8s_client" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/09/07/K8s_client/" class="article-date">
  <time class="dt-published" datetime="2020-09-07T09:15:29.000Z" itemprop="datePublished">2020-09-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="K8s：调用Java接口创建容器"><a href="#K8s：调用Java接口创建容器" class="headerlink" title="K8s：调用Java接口创建容器"></a>K8s：调用Java接口创建容器</h1><h2 id="Extract"><a href="#Extract" class="headerlink" title="Extract"></a>Extract</h2><p><a target="_blank" rel="noopener" href="https://www.kubernetes.org.cn/"><strong>Kubernetes</strong></a>是一个开源的，用于管理云平台中多个主机上的容器化的应用，Kubernetes的目标是让部署容器化的应用简单并且高效（powerful）, Kubernetes提供了应用部署，规划，更新，维护的一种机制。</p>
<p>控制台<code>kubectl</code>命令可以帮助我们操作K8s部署Deployment、pod、Service等，但当遇到批量部署的情况，以及实现自动化云端服务的时候，如何在后端调用接口则显得尤为重要。</p>
<h2 id="依赖"><a href="#依赖" class="headerlink" title="依赖"></a>依赖</h2><p>引入Maven依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.kubernetes<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>client-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>9.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.kubernetes<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>client-java-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">version</span>&gt;</span>9.0.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="创建容器"><a href="#创建容器" class="headerlink" title="创建容器"></a>创建容器</h2><p>![image-20200907210934572](/Users/giotto/Library/Mobile Documents/27N4MQEA55<del>pro</del>writer/Documents/K8s_client/image-20200907210934572.png)</p>
<p>根据官方更新日志，<code>9.0.0+</code> 版本以上更新了<code>GenericKubernetesApi</code>，但是经过我的使用发现，该接口在创建容器失败后，没有合适的对象封装异常，我们无法得知容器创建失败的原因，经过在github询问贡献者得知：</p>
<p>![image-20200907211507320](/Users/giotto/Library/Mobile Documents/27N4MQEA55<del>pro</del>writer/Documents/K8s_client/image-20200907211507320.png)</p>
<p>根据现有版本的设计，需要使用<code>V1Status</code>接收返回的对象排查错误。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">      Call call = callBuilder.build();</span><br><span class="line">      call = tweakCallForCoreV1Group(call);</span><br><span class="line">      JsonElement element = apiClient.&lt;JsonElement&gt;execute(call, JsonElement.class).getData();</span><br><span class="line">      <span class="keyword">return</span> getKubernetesApiResponse(dataClass, element, apiClient.getJSON().getGson());</span><br><span class="line">    &#125; <span class="keyword">catch</span> (ApiException e) &#123;</span><br><span class="line">      <span class="keyword">if</span> (e.getCause() <span class="keyword">instanceof</span> IOException) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(e.getCause()); <span class="comment">// make this a checked exception?</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">final</span> V1Status status;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        status = apiClient.getJSON().deserialize(e.getResponseBody(), V1Status.class);</span><br><span class="line">      &#125; <span class="keyword">catch</span> (JsonSyntaxException jsonEx) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(jsonEx);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">null</span> == status) &#123; <span class="comment">// the response body can be something unexpected sometimes..</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> KubernetesApiResponse&lt;&gt;(status, e.getCode());</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>以下出于使用方便考虑，依旧采用旧版本的接口调用K8s。</p>
<p>通过K8s接口创建容器大致分三步：</p>
<blockquote>
<pre><code>1. 创建与K8s api-server的连接；
 2. 构造容器接口；
 3. 构造容器对象；
 4. 调用容器接口创建容器。
</code></pre>
</blockquote>
<h3 id="创建Deployment"><a href="#创建Deployment" class="headerlink" title="创建Deployment"></a>创建Deployment</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line">   ApiClient apiClient = <span class="keyword">new</span> ApiClient();</span><br><span class="line"></span><br><span class="line"><span class="comment">//配置K8s ApiServer地址</span></span><br><span class="line">   apiClient.setBasePath(<span class="string">&quot;http://localhost:8080&quot;</span>);</span><br><span class="line">   Configuration.setDefaultApiClient(<span class="keyword">this</span>.apiClient);</span><br><span class="line"></span><br><span class="line"><span class="comment">//配置Deployment接口</span></span><br><span class="line">   <span class="keyword">private</span> AppsV1Api appsV1Api;</span><br><span class="line">   appsV1Api = <span class="keyword">new</span> AppsV1Api(<span class="keyword">this</span>.apiClient);</span><br><span class="line"></span><br><span class="line"><span class="comment">//配置标签</span></span><br><span class="line">   Map&lt;String, String&gt; matchLabels = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">   matchLabels.put(<span class="string">&quot;app&quot;</span>, podName);</span><br><span class="line">   matchLabels.put(<span class="string">&quot;env&quot;</span>, env);</span><br><span class="line"></span><br><span class="line"><span class="comment">//配置端口</span></span><br><span class="line">   List&lt;V1ContainerPort&gt; portList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">   V1ContainerPort port = <span class="keyword">new</span> V1ContainerPort();</span><br><span class="line">   port.setName(<span class="string">&quot;httpd&quot;</span>);</span><br><span class="line">   port.setContainerPort(<span class="number">80</span>);</span><br><span class="line">   portList.add(port);</span><br><span class="line"></span><br><span class="line">   List&lt;V1EnvVar&gt; envs = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line">   V1EnvVar clientIdEnv = <span class="keyword">new</span> V1EnvVar();</span><br><span class="line">   clientIdEnv.setName(<span class="string">&quot;client_id&quot;</span>);</span><br><span class="line">   clientIdEnv.setValue(clientId);</span><br><span class="line">   envs.add(clientIdEnv);</span><br><span class="line">   V1EnvVar clientSecretEnv = <span class="keyword">new</span> V1EnvVar();</span><br><span class="line">   clientSecretEnv.setName(<span class="string">&quot;client_secret&quot;</span>);</span><br><span class="line">   clientSecretEnv.setValue(clientSecret);</span><br><span class="line">   envs.add(clientSecretEnv);</span><br><span class="line">   V1EnvVar redirectEnv = <span class="keyword">new</span> V1EnvVar();</span><br><span class="line">   redirectEnv.setName(<span class="string">&quot;redirect_uri&quot;</span>);</span><br><span class="line">   redirectEnv.setValue(redirectUri);</span><br><span class="line">   envs.add(redirectEnv);</span><br><span class="line"></span><br><span class="line"><span class="comment">//使用对象封装Deployment</span></span><br><span class="line">   V1Deployment deploy =</span><br><span class="line">       <span class="keyword">new</span> V1DeploymentBuilder()</span><br><span class="line">           .withApiVersion(<span class="string">&quot;apps/v1&quot;</span>)</span><br><span class="line">           .withKind(<span class="string">&quot;Deployment&quot;</span>)</span><br><span class="line">           .withNewMetadata()</span><br><span class="line">           .withName(deploymentName)</span><br><span class="line">           .withNamespace(<span class="string">&quot;default&quot;</span>)</span><br><span class="line">           .endMetadata()</span><br><span class="line">           .withNewSpec()</span><br><span class="line">           .withReplicas(<span class="number">1</span>)</span><br><span class="line">           .withNewSelector()</span><br><span class="line">           .withMatchLabels(matchLabels)</span><br><span class="line">           .endSelector()</span><br><span class="line">           .withNewTemplate()</span><br><span class="line">           .withNewMetadata()</span><br><span class="line">           .withLabels(matchLabels)</span><br><span class="line">           .endMetadata()</span><br><span class="line">           .withNewSpec()</span><br><span class="line">           .withContainers(</span><br><span class="line">               <span class="keyword">new</span> V1Container()</span><br><span class="line">                   .name(podName)</span><br><span class="line">                   .image(<span class="string">&quot;cgwire&quot;</span>)</span><br><span class="line">                   .imagePullPolicy(<span class="string">&quot;Never&quot;</span>)</span><br><span class="line">                   .ports(portList)</span><br><span class="line">                   .env(envs))</span><br><span class="line">           .endSpec()</span><br><span class="line">           .endTemplate()</span><br><span class="line">           .endSpec().build();</span><br><span class="line">           <span class="keyword">try</span> &#123;</span><br><span class="line">               <span class="comment">//调用容器接口创建Deployment</span></span><br><span class="line">               appsV1Api.createNamespacedDeployment(</span><br><span class="line">                   <span class="string">&quot;default&quot;</span>,	<span class="comment">//namespace</span></span><br><span class="line">                   deploy,		<span class="comment">//Deployment对象</span></span><br><span class="line">                   <span class="string">&quot;true&quot;</span>,		<span class="comment">//pretty</span></span><br><span class="line">                   <span class="keyword">null</span>,		<span class="comment">//dryRun</span></span><br><span class="line">                   <span class="keyword">null</span>);		<span class="comment">//fieldManager               </span></span><br><span class="line">         &#125; <span class="keyword">catch</span> (ApiException e) &#123;</span><br><span class="line">           <span class="keyword">throw</span> <span class="keyword">new</span> FastRuntimeException(BizCode.SERVICE_UNAVAILABLE.getCode(),e.getResponseBody());</span><br><span class="line">         &#125;</span><br></pre></td></tr></table></figure>



<h3 id="创建Service"><a href="#创建Service" class="headerlink" title="创建Service"></a>创建Service</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">   ApiClient apiClient = <span class="keyword">new</span> ApiClient();</span><br><span class="line"></span><br><span class="line"><span class="comment">//配置K8s ApiServer地址</span></span><br><span class="line">   apiClient.setBasePath(<span class="string">&quot;http://localhost:8080&quot;</span>);</span><br><span class="line">   Configuration.setDefaultApiClient(<span class="keyword">this</span>.apiClient);</span><br><span class="line"></span><br><span class="line"><span class="comment">//配置Service接口</span></span><br><span class="line">CoreV1Api coreV1Api = <span class="keyword">new</span> CoreV1Api(apiClient);</span><br><span class="line"></span><br><span class="line"><span class="comment">//构造Service对象</span></span><br><span class="line">	Map&lt;String, String&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">   map.put(<span class="string">&quot;app&quot;</span>, podName);</span><br><span class="line">   map.put(<span class="string">&quot;env&quot;</span>, env);</span><br><span class="line">   V1Service svc =</span><br><span class="line">       <span class="keyword">new</span> V1ServiceBuilder()</span><br><span class="line">           .withApiVersion(<span class="string">&quot;v1&quot;</span>)</span><br><span class="line">           .withKind(<span class="string">&quot;Service&quot;</span>)</span><br><span class="line">           .withNewMetadata()</span><br><span class="line">           .withName(serviceName)</span><br><span class="line">           .withNamespace(<span class="string">&quot;default&quot;</span>)</span><br><span class="line">           .endMetadata()</span><br><span class="line">           .withNewSpec()</span><br><span class="line">           .withSelector(map)</span><br><span class="line">           .addNewPort()</span><br><span class="line">           .withName(<span class="string">&quot;http&quot;</span>)</span><br><span class="line">           .withPort(<span class="number">80</span>)</span><br><span class="line">           .withTargetPort(<span class="keyword">new</span> IntOrString(<span class="number">80</span>))</span><br><span class="line">           .endPort()</span><br><span class="line">           .endSpec()</span><br><span class="line">           .build();</span><br><span class="line"></span><br><span class="line">   <span class="keyword">try</span> &#123;</span><br><span class="line">       <span class="comment">//调用接口操作K8s创建Service</span></span><br><span class="line">         coreV1Api.createNamespacedService(</span><br><span class="line">             svc.getMetadata().getNamespace(),	<span class="comment">//namespace</span></span><br><span class="line">             svc,								<span class="comment">//Service对象</span></span><br><span class="line">             <span class="string">&quot;true&quot;</span>,							<span class="comment">//pretty</span></span><br><span class="line">             <span class="keyword">null</span>,								<span class="comment">//dryRun</span></span><br><span class="line">             <span class="keyword">null</span>								<span class="comment">//fieldManager</span></span><br><span class="line">         );</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">catch</span> (ApiException e) &#123;</span><br><span class="line">     <span class="keyword">throw</span> <span class="keyword">new</span> FastRuntimeException(BizCode.SERVICE_UNAVAILABLE.getCode(),e.getResponseBody());</span><br><span class="line">   &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>



<h3 id="创建Ingress"><a href="#创建Ingress" class="headerlink" title="创建Ingress"></a>创建Ingress</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">   ApiClient apiClient = <span class="keyword">new</span> ApiClient();</span><br><span class="line"></span><br><span class="line"><span class="comment">//配置K8s ApiServer地址</span></span><br><span class="line">   apiClient.setBasePath(<span class="string">&quot;http://localhost:8080&quot;</span>);</span><br><span class="line">   Configuration.setDefaultApiClient(<span class="keyword">this</span>.apiClient);</span><br><span class="line"></span><br><span class="line"><span class="comment">//配置Ingress接口</span></span><br><span class="line">ExtensionV1beta1Api extensionsV1beta1Api = <span class="keyword">new</span> ExtensionsV1beta1Api(<span class="keyword">this</span>.apiClient);</span><br><span class="line"></span><br><span class="line"><span class="comment">//构造Ingress对象</span></span><br><span class="line">Map&lt;String, String&gt; annotations = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">   annotations.put(<span class="string">&quot;kubernetes.io/ingress.class&quot;</span>, <span class="string">&quot;nginx&quot;</span>);</span><br><span class="line"></span><br><span class="line">   List&lt;ExtensionsV1beta1HTTPIngressPath&gt; ingressPaths = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">   ExtensionsV1beta1HTTPIngressPath path =</span><br><span class="line">       <span class="keyword">new</span> ExtensionsV1beta1HTTPIngressPath()</span><br><span class="line">           .path(<span class="string">&quot;/&quot;</span>)</span><br><span class="line">           .backend(</span><br><span class="line">               <span class="keyword">new</span> ExtensionsV1beta1IngressBackend()</span><br><span class="line">                   .serviceName(serviceName)</span><br><span class="line">                   .servicePort(<span class="keyword">new</span> IntOrString(<span class="number">80</span>)));</span><br><span class="line">   ingressPaths.add(path);</span><br><span class="line"></span><br><span class="line">   ExtensionsV1beta1Ingress ingress =</span><br><span class="line">       <span class="keyword">new</span> ExtensionsV1beta1IngressBuilder()</span><br><span class="line">           .withApiVersion(<span class="string">&quot;extensions/v1beta1&quot;</span>)</span><br><span class="line">           .withKind(<span class="string">&quot;Ingress&quot;</span>)</span><br><span class="line">           .withNewMetadata()</span><br><span class="line">           .withName(<span class="string">&quot;ingress-&quot;</span> + subDomain)</span><br><span class="line">           .withNamespace(<span class="string">&quot;default&quot;</span>)</span><br><span class="line">           .withAnnotations(annotations)</span><br><span class="line">           .endMetadata()</span><br><span class="line">           .withNewSpec()</span><br><span class="line">           .withRules(</span><br><span class="line">               <span class="keyword">new</span> ExtensionsV1beta1IngressRule()</span><br><span class="line">                   .host(subDomain+<span class="string">&quot;.cgclass.net&quot;</span>)</span><br><span class="line">                   .http(</span><br><span class="line">                       <span class="keyword">new</span> ExtensionsV1beta1HTTPIngressRuleValue()</span><br><span class="line">                           .paths(ingressPaths)))</span><br><span class="line">           .endSpec()</span><br><span class="line">           .build();</span><br><span class="line">   <span class="keyword">try</span> &#123;</span><br><span class="line">       <span class="comment">//调用容器接口创建Ingress</span></span><br><span class="line">     	extensionsV1beta1Api.createNamespacedIngress(</span><br><span class="line">         ingress.getMetadata().getNamespace(),	<span class="comment">//namespace</span></span><br><span class="line">         ingress,								<span class="comment">//Ingress对象</span></span><br><span class="line">         <span class="string">&quot;true&quot;</span>,								<span class="comment">//pretty</span></span><br><span class="line">         <span class="keyword">null</span>,									<span class="comment">//dryRun</span></span><br><span class="line">         <span class="keyword">null</span>									<span class="comment">//fieldManager</span></span><br><span class="line">     );</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="keyword">catch</span> (ApiException e) &#123;</span><br><span class="line">     <span class="keyword">throw</span> <span class="keyword">new</span> FastRuntimeException(BizCode.SERVICE_UNAVAILABLE.getCode(),e.getResponseBody());</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>



<h2 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h2><p>该版本的容器接口会抛出封装好的异常对象<code>ApiException</code>，通过捕获<code>ApiException</code>我们可以找到容器创建失败的原因：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">  extensionsV1beta1Api.createNamespacedIngress(</span><br><span class="line">      ingress.getMetadata().getNamespace(),</span><br><span class="line">      ingress,</span><br><span class="line">      <span class="string">&quot;true&quot;</span>,</span><br><span class="line">      <span class="keyword">null</span>,</span><br><span class="line">      <span class="keyword">null</span></span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span> (ApiException e) &#123;</span><br><span class="line">  System.out.println(e.getCause());</span><br><span class="line">  System.out.println(e.getMessage());</span><br><span class="line">  System.out.println(e.getResponseBody());</span><br><span class="line">  System.out.println(e.getStackTrace());</span><br><span class="line">  System.out.println(e.getCode());</span><br><span class="line">  System.out.println(e.getResponseHeaders());</span><br><span class="line">  System.out.println(e.getLocalizedMessage());</span><br><span class="line">  System.out.println(e.getSuppressed());</span><br><span class="line">  <span class="keyword">throw</span> <span class="keyword">new</span> FastRuntimeException(BizCode.SERVICE_UNAVAILABLE.getCode(),e.getResponseBody());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>创建容器的流程看似复杂，但是思路十分清晰，先通过<code>ApiClient</code>创建与K8s的连接，然后初始化与该容器相匹配的容器接口，如<code>AppsV1Api</code> , <code>CoreV1Api</code> 或<code>ExtensionsV1beta1Api</code> ，将容器信息封装到对象<code>V1Deployment</code> , <code>V1Service</code> , <code>ExtensionsV1beta1Ingress</code> 中，最后调用容器接口创建容器并处理异常信息。</p>
<p><code>kubernetes-client/java</code> 目前网上教程内容较少并且质量堪忧（CSDN最近复制粘贴风气堪忧），只能借助于官方文档与实例，所以我将我的理解分享给大家，如有更好的解决方案，也欢迎大家与我交流。</p>
<p><strong>Talk is cheap, show me the code.</strong></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/09/07/K8s_client/" data-id="ckua4t7hm000yvxgtgcmcg59v" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Springcloud_zipkin" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/09/06/Springcloud_zipkin/" class="article-date">
  <time class="dt-published" datetime="2020-09-06T01:44:30.000Z" itemprop="datePublished">2020-09-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="Extract"><a href="#Extract" class="headerlink" title="Extract"></a>Extract</h2><p>Zipkin是一个开源的分布式实时数据追踪系统（Distributed Tracking System），每个Service向Zipkin报告请求数据，Zipkin会根据调用关系通过Zipkin UI生成依赖关系图，让开发者通过一个Web前端轻松的收集和分析数据，如用户每次请求服务的处理事件等，可方便分析系统中存在的瓶颈。</p>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>随着业务越来越复杂，系统也随之需要进行拆分，特别是随着微服务架构和容器技术的兴起，看似简单的应用，后端可能需要多个Service的支持。当前端向后发送请求，后端可能需要进行多次Service调用才能完成，当请求变慢或者不可用时，单凭我们无法得知是哪个后端Service引起的，这时就需要快速定位故障点，Zipkin就可以很好的解决这样的问题。</p>
<p>这里我是在Spring Cloud的基础上搭建的Zipkin。</p>
<h2 id="pom-xml"><a href="#pom-xml" class="headerlink" title="pom.xml"></a>pom.xml</h2><p>创建Zipkin微服务，并引入依赖，主要是两个<code>zipkin-server</code>和<code>zipkin-autoconfigure-ui</code>：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.zipkin.java<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>zipkin-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.11.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.zipkin.java<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>zipkin-autoconfigure-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.11.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>



<p>需要注意的是：</p>
<ol>
<li> 这里的version如果不匹配会发生各种奇怪的异常导致程序跑不起来，所以如果你的程序报异常，建议你检查一下zipkin版本以及SpringBoot、SpringCloud的版本；</li>
<li> <code>zipkin-server</code>中包含了<code>log4j-slf4j-impl</code>这个组件，这可能会与springboot中的<code>logback</code>重复产生异常如下，如果出现只需在<code>zipkin-server</code>的dependency中添加<code>&lt;exclusion&gt;</code>将<code>log4j-slf4j-impl</code>排除即可。</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[ERROR] [XXX Enforcer Rules] find DuplicateClasses</span><br><span class="line"></span><br><span class="line">Found in:</span><br><span class="line">org.apache.logging.log4j:log4j-slf4j-impl:jar:2.6.2:compile</span><br><span class="line">ch.qos.logback:logback-classic:jar:1.1.7:compile</span><br><span class="line">Duplicate classes:</span><br><span class="line">org/slf4j/impl/StaticMDCBinder.class</span><br><span class="line">org/slf4j/impl/StaticMarkerBinder.class</span><br><span class="line">org/slf4j/impl/StaticLoggerBinder.class</span><br></pre></td></tr></table></figure>

<p>另外引入如下依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0.4.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.vintage<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-vintage-engine<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;dependency&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--            &lt;artifactId&gt;spring-boot-starter-actuator&lt;/artifactId&gt;--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--        &lt;/dependency&gt;--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.junit.jupiter<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit-jupiter-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.6.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h2 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h2><p>修改配置文件：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将zipkin注册到erueka上</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://localhost:8761/eureka</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置zipkin端口</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8769</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置服务名字</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">spring-cloud-zipkin2</span></span><br></pre></td></tr></table></figure>

<p>上面就是我们给zipkin的配置，但是若是在启动过程中报出异常<code>[java.lang.IllegalArgumentException: Prometheus requires that all meters with the same name have the same set of tag keys.]</code>，此时我们就需要在配置文件中添加：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">management:</span></span><br><span class="line">  <span class="attr">metrics:</span></span><br><span class="line">    <span class="attr">web:</span></span><br><span class="line">      <span class="attr">server:</span></span><br><span class="line">        <span class="attr">auto-time-requests:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>



<h2 id="Application"><a href="#Application" class="headerlink" title="Application"></a>Application</h2><p>修改Application添加注解<code>@EnableEurekaClient</code>以及<code>EnableZipkinServer</code>。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.giotto.demozipkin2;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.SpringApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.netflix.eureka.EnableEurekaClient;</span><br><span class="line"><span class="keyword">import</span> zipkin2.server.internal.EnableZipkinServer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableEurekaClient</span></span><br><span class="line"><span class="meta">@EnableZipkinServer</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoZipkin2Application</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(DemoZipkin2Application.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="Service端"><a href="#Service端" class="headerlink" title="Service端"></a>Service端</h2><p>当ZipkinServer端配置好后，我们同样需要在Service中配置Zipkin，这样才能将数据实时发送到ZipkinServer，首先给需要配置Zipkin的Service添加如下依赖：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-sleuth<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-sleuth-zipkin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在配置文件中，配置Zipkin：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">	<span class="attr">zipkin:</span></span><br><span class="line">		<span class="attr">base-url:</span> <span class="string">http://localhost:port</span></span><br><span class="line">	<span class="attr">sleuth:</span></span><br><span class="line">		<span class="attr">sampler:</span></span><br><span class="line">			<span class="attr">probability:</span> <span class="number">1.0</span></span><br></pre></td></tr></table></figure>



<h2 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h2><p>启动后，只需访问<code>http://localhost:port/zipkin/</code>即可。</p>
<img src="/Users/giotto/Library/Mobile Documents/27N4MQEA55~pro~writer/Documents/Springcloud_zipkin/image-20200607212054704.png" alt="image-20200607212054704" style="zoom:80%;" />


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/09/06/Springcloud_zipkin/" data-id="ckua4t7hr001bvxgt32f66zzy" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Extract_2020_2_6" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/09/06/Extract_2020_2_6/" class="article-date">
  <time class="dt-published" datetime="2020-09-06T01:44:27.000Z" itemprop="datePublished">2020-09-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="摘录-《在怀疑的时代依然需要信仰》"><a href="#摘录-《在怀疑的时代依然需要信仰》" class="headerlink" title="摘录-《在怀疑的时代依然需要信仰》"></a>摘录-《在怀疑的时代依然需要信仰》</h1><h2 id="Extract"><a href="#Extract" class="headerlink" title="Extract"></a>Extract</h2><p>卢新宁 在北京大学中文系毕业典礼上的演讲</p>
<h2 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h2><p>敬爱的老师和亲爱的同学们：</p>
<p>上午好！</p>
<p>谢谢你们叫我回家。让我有幸再次聆听老师的教诲，分享我亲爱的学弟学妹们的特殊喜悦。一进家门，光阴倒转，刚才那些美好的视频，同学的发言，老师的讲话，都让我觉得所有年轻的故事都不曾走远。可是，站在你们面前，亲爱的同学们，我才发现，自己真的老了。1988年，我本科毕业的时候，你们中的绝大多数人还没有出生。那个时候你们的朗朗部长还是众女生仰慕的帅师兄，你们的渭毅老师正与我的同屋女孩爱得地老天荒。而他们的孩子都该考大学了。</p>
<p>就像刚才那首歌唱的，“记忆中最美的春天，难以再回首的昨天”。如果把生活比作一段将理想“变现”的历程，我们只是一叠面额有限的现钞，而你们是即将上市的股票。从一张白纸起步的书写，前程无远弗届，一切皆有可能。面对你们，我甚至缺少一分抒发“过来人”心得的勇气。</p>
<p>但我先生力劝我来，我的朋友也劝我来，他们都是84级的中文系学长。今天，他们有的仍然是一介文人，清贫淡泊；有的已经主政一方，功成名就；有的发了财做了“富二代”的爹，也有的离了婚、生活并不如意，但在网上交流时，听说有今天这样一个机会，他们都无一例外地让我一定要来，代表他们，代表那一代人，向自己的弟弟妹妹说点什么。</p>
<p>是的，跟你们一样，我们曾在中文系就读，甚至读过同一门课程，青涩的背影都曾被燕园的阳光，定格在五院青藤缠满的绿墙上。但那是上个世纪的事了，我们之间横亘着20多年的时光。那个时候我们称为理想的，今天或许你们笑称其为空想；那时的我们流行书生论政，今天的你们要面对诫勉谈话；那时的我们熟悉的热词是民主、自由，今天的你们记住的是“拼爹”、“躲猫猫”、“打酱油”；那个时候的我们喜欢在三角地游荡，而今天的你们习惯隐形于伟大的互联网。</p>
<p>我们那时的中国依然贫穷却豪情万丈，而今天这个世界第二大经济体，还在苦苦寻找迷失的幸福，无数和你们一样的青年喜欢用“囧”形容自己的处境。</p>
<p>20多年时光，中国到底走了多远？存放我们青春记忆的“三角地”早已荡然无存，见证你们少年心绪的“一塔湖图”正在创造新的历史。你们这一代人，有着远比我们当年更优越的条件，更广博的见识，更成熟的内心，站在更高的起点。</p>
<p>我们想说的是，站在这样高的起点，由北大中文系出发，你们不缺前辈大师的庇荫，更不少历史文化的熏染。《诗经》《楚辞》的世界，老庄孔孟的思想，李白杜甫的词章，构成了你们生命中最为激荡的青春时光。我不需要提醒你们，未来将如何以具体琐碎消磨这份浪漫与绚烂；也不需要提醒你们，人生将以怎样的平庸世故，消解你们的万丈雄心；更不需要提醒你们，走入社会，要如何变得务实与现实，因为你们终将以一生浸淫其中。</p>
<p>我唯一的害怕，是你们已经不相信了——不相信规则能战胜潜规则，不相信学场有别于官场，不相信学术不等于权术，不相信风骨远胜于媚骨。</p>
<p>你们或许不相信了，因为追求级别的越来越多，追求真理的越来越少；讲待遇的越来越多，讲理想的越来越少；大官越来越多，大师越来越少。</p>
<p>因此，在你们走向社会之际，我想说的只是，请看护好你曾经的激情和理想。在这个怀疑的时代，我们依然需要信仰。</p>
<p>也许有同学会笑话，大师姐写报社论写多了吧，这么高的调子。可如果我告诉各位，这是我的那些中文系同学，那些不管今天处于怎样的职位，遭遇过怎样的人生的同学共同的想法，你们是否会稍微有些重视？是否会多想一下为什么二十多年过去，他们依然如此？</p>
<p>我知道，与我们这一代相比，你们这一代人的社会化远在你们踏上社会之前就已经开始了，国家的盛世集中在你们的大学时代，但社会的问题也凸显在你们的青春岁月。你们有我们不曾拥有的机遇，但也有我们不曾经历的挑战。</p>
<p>文学理论无法识别毒奶粉的成分，古典文献挡不住地沟油的泛滥。当利益成为唯一的价值，很多人把信仰、理想、道德都当成交易的筹码，我很担心，“怀疑”会不会成为我们时代否定一切、解构一切的“粉碎机”？我们会不会因为心灰意冷而随波逐流，变成钱理群先生所言“精致利己主义”，世故老到，善于表演，懂得配合？而北大会不会像那个日本年轻人所说的，“有的是人才，却并不培养精英”？</p>
<p>我有一位清华毕业的同事，从大学开始，就自称是“北大的跟屁虫”。对北大人甚是敬重。谈到“大清王朝北大荒”江湖传言，他特认真地对我说：“这个社会更需要的，不是北大人的适应，而是北大人的坚守。”</p>
<p>这让我想起中文系百年时，陈平原先生的一席话。他提到西南联大时的老照片给自己的感动：一群衣衫褴褛的知识分子，器宇轩昂地屹立于天地间。这应当就是国人眼里北大人的形象。不管将来的你们身处何处，不管将来的你们从事什么职业，是否都能常常自问，作为北大人，我们是否还存有那种浩然之气？那种精神的魅力，充实的人生，“天地之心、生民之命、往圣绝学”，是否还能在我们心中激起共鸣？</p>
<p>马克思曾慨叹，法兰西不缺少有智慧的人但缺少有骨气的人。今天的中国，同样不缺少有智慧的人但缺少有信仰的人。也正因此，中文系给我们的教育，才格外珍贵。</p>
<p>从母校的教诲出发，20多年社会生活给的我最大启示是：当许多同龄人都陷于时代的车轮下，那些能幸免的人，不仅因为坚强，更因为信仰。不用害怕圆滑的人说你不够成熟，不用在意聪明的人说你不够明智，不要照原样接受别人推荐给你的生活，选择坚守、选择理想，选择倾听内心的呼唤，才能拥有最饱满的人生。</p>
<p>梁漱溟先生写过一本书《这个世界会好吗？》。我很喜欢这个书名，它以朴素的设问提出了人生的大问题。这个世界会好吗？事在人为，未来中国的分量和质量，就在各位的手上。</p>
<p>最后，我想将一位学者的话送给亲爱的学弟学妹——无论中国怎样，请记得：你所站立的地方，就是你的中国；你怎么样，中国便怎么样；你是什么，中国便是什么；你有光明，中国便不会黑暗。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/09/06/Extract_2020_2_6/" data-id="ckua4t7hk000rvxgt4fujcs4l" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2019Report" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/01/12/2019Report/" class="article-date">
  <time class="dt-published" datetime="2020-01-12T08:11:29.000Z" itemprop="datePublished">2020-01-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="我的2019年终总结"><a href="#我的2019年终总结" class="headerlink" title="我的2019年终总结"></a>我的2019年终总结</h1><font face="楷体">

<blockquote>
<p>满桌的旧瓶新酒，放不下旧恨新愁 </p>
<p>荒废了光阴锦绣，愧对一身行头 </p>
<p>仰望漫天的星斗，便梦回功成名就</p>
</blockquote>
<p>&emsp;&emsp;2019年，这一年就像上了发条的铁皮青蛙，没头没脑的闯进了23岁的九局下半，我没有将帽子反戴，但也还依旧期待着逆转。</p>
<div align="center">
<img src="2019Report/img01.JPG" width=80%>
</div>



<p>一月，刚刚结束了研究生初试，我又回到了烟台，休息了几天，收拾收拾了行李便准备回家过年了。奇怪的是今年一点都没有考完试的兴奋感。</p>
<div align="center">
<img src="2019Report/img02.JPG" width="80%">
</div>





<p>二月，本该是享受假期的时候，结果得了急性咽炎伴随着低烧，每天只能吃面条、忌辛辣、忌油腻，如果我记得不错，那天是大年初一，运气还真是不太好。后来，二月中旬考研初试成绩公布了，数学和政治依旧不是很好，对于政治总感觉像是一拳打在了棉花上，无处发力。数学成绩反而令我有些意外，因为交完卷子的时候，自我感觉还不错，但是我一向自我感觉还不错就是了。</p>
<div align="center">
<img src="2019Report/img03.JPG" width=80%>
</div>



<p>三月，距离复试的时间越来越近，为了多尽尽人事，我提前结束了假期，选择了校内调剂，去济南准备软件工程的复试，此时距离复试大概还有二十多天，等我到了济南，才发现两个学院的复试科目不一样，我只好从头开始复习，也是从一头雾水到略知一二，最后是终于把复试应付过去了。</p>
<p>之后，回到烟台没呆几天，一方面确实有点闲，另一方面为了给自己多一条后路，在收到黑龙江大学的复试通知后的第三天，琪琪和我就飞去了哈尔滨，准备参加黑大的复试，这也是我第一次来到东北。复试大概只花了一天时间，内容也比较简单，只是纯粹的面试。作为在哈尔滨的最后一餐，我们寻着人生一串纪录片的指引找到哈尔滨的这家烧烤店，地方不大，味道不错，烤牛肉干很有嚼劲。当我知道自己会被黑大录取的时候，我的心情比没被录取还纠结，山大的录取结果还没出，如果黑大先出了，那我就不得不在规定时间内确认录取，还好当我抵达蓬莱国际机场，关掉了手机的飞行模式，我收到了姑父发给我的录取公示名单。这一次我的运气依旧不错。</p>
<div align="center">
<img src=2019Report/img04.jpg width=80%>
</div>



<p>四月，这是我在烟台的最后一个月，我开始真正开始享受我的Gap year。每天吃吃喝喝玩玩，这时候我应该有150斤。这个月和琪琪去了威海的野生动物园，是我突然想到的的，这个动物园在我印象中很大，但我不确定它还在不在，因为我上一次去还是我四年级的时候，那时候还是和我哥一起去的，想想都已经是十二年前的事了，有些唏嘘。</p>
<div align="center">
<img src="2019Report/img05.JPG" width=80%>
</div>



<p>五月，我终于抵挡不住来自导师的攻势，我提前来到了实验室学习。也是这个月我的网站<a href="giottolee.com">SilverBullet</a>也开始搭建起来了。主要目的其实也不是分享，只是作为方便自己以后需要做点什么东西，以前做过，我就可以直接上去找到，省去了一些百度的麻烦，可能主要还是因为懒。我的生活开始变得极其规律，早上七点起床，吃个早饭然后去实验室，看看新闻刷会B站看看球，看看老师给安排的内容。到点就去吃午饭，然后回去睡个一个小时午觉，下午回到实验室继续消磨时间，到了四五点钟，就偷偷溜去球场打打球，也因为篮球，我又认识了一群新的球友。那时候的生活规律的简直不像是自己，比如上个月我们宿舍去实验室的时间一度拖延到上午十点，现在是晚上的01:52，我还依旧在写着这些乱七八糟的东西。</p>
<div align="center">
<img src="2019Report/img06.JPG" width=80%>
</div>



<p>六月，我拿到了我的第二份入学通知，正式从一个无业游民又变回了一个新生，美职篮也正式迎来了新王。话说，过年的时候收到了卡酱的球衣，四个月过去，猛龙夺了冠，我在想这是不是有些玄学，毕竟谁也没想到总决赛上站出来的是那位乔丹。这里我建议曲总尽快把湖人球衣安排上，今年我要看铁林投三分。</p>
<div align="center">
<img src="2019Report/img07.jpg" width=80%>
</div>



<p>七月，和琪琪去了南京，逛了南京博物院、去了南师大、爬了鸡鸣寺、游了玄武湖、转了总统府、看了动物园。后来又转去上海，住了虎扑x亚朵的合作酒店，打了两天球，吃了糖水铺子，在上海的两天，生理上与心理上都完完全全被我摁在了舒适区，因为天气太热，着实不太想出门。果然自己还是比较适合休闲游，能吃不累就是最好旅行。当我从上海回到学校，我的宿舍也从单人间降级到了四人间，我多了三个新舍友。</p>
<div align="center">
<img src="2019Report/img08.JPG" width=80%>
</div>



<p>八月，这个月老老实实呆在学校里继续摸鱼生活，回家也没有什么事情做，索性在学校打打球减减肥，也是在这个月，我的体重重新从150斤回到了曾经的140斤，再也不用躺在床上摸着一肚子罪恶感睡觉了。这个月陆陆续续下了好长时间的雨，济南也着实凉爽了那么几天，雨后的草腥味，是我好久没有闻到的味道了，或许因为沿海，烟台下过雨的味道远没有这么清冽。</p>
<div align="center">
<img src="2019Report/img09.JPG" width=80%>
</div>



<p>九月，匆匆忙忙的再一次走入大学生活，又参加了一次开学典礼，又拿到了一张校园卡。我记得在之前没开学前，我还跟舍友说不想天天呆实验室，想上课。九月，两个周，我后悔了。</p>
<div align="center">
<img src="2019Report/img10.JPG" width=80%>
</div>



<p>十月，我一直以为20多岁应该是人身体状态最好的一段时间，但事实上我发现最近两年身体却在慢慢出现一些小毛病，背包走太久会肩膀疼，打球太频繁会膝盖疼，脚踝手指扭一下要一个多月才能好，实在不太想承认身体要开始走下坡路了。习惯上也变得越来越趋于养生，每天除了上课、实验室、吃饭就是睡觉，想想以前的大学生活，好像完全是两个世界。</p>
<div align="center">
<img src="2019Report/img11.JPG" width=80%>
</div>



<p>十一月，结束了自己的第一次研究生赛，又是十六强，为什么说又呢？因为我记得之前自己第一次打院赛好像也是十六强。其实基本上没怎么打，自己还是太弱了，马上就要入冬了，趁着这时候多练一练力量养一养膝盖，等天气暖和了再好好练练球，希望明年能再多走两步。</p>
<div align="center">
<img src="2019Report/img12.jpg" width=80%>
</div>



<p>十二月，感觉一眨眼这学期就这么过来了。好像几乎都在准备期末考试，周末也打了几次球，可能是因为天气确实比较冷，髌腱出现了一些炎症，我向保暖裤做出了最后的妥协。</p>
<div align="center">
<img src="2019Report/img13.JPG" width=80%>
</div>



<p>这是我的第四次年终总结了，2017年的元旦，哈尔滨跨年计划失败，躺在床上闲着无聊，我写下了我的第一篇年终总结，然后2018、2019直到今年2020年，其实写到现在这东西真的有什么意义吗？好像也没什么意义，顶多能让我知道去年这一年钱都花在哪了，能让我知道我这一年好像也没闲着。但这件事情每到这个时间段，总是会逼迫我去回忆这一年都发生了什么，可能这也就是这件事本身的意义了。</p>
<p>就像稻盛和夫所说的：“不论你多么富有，多么有权势，当生命结束之时，所有的一切都只能留在世界上，唯有灵魂跟着你走下一段旅程。人生不是一场物质的盛宴，而是一次灵魂的修炼，使它在谢幕之时比开幕之初更为高尚。”</p>
<p>昨天在虎扑上看到一JR志愿前往武汉参与救助，理由是<strong>“人这一辈子总要去做点牛逼的事情”</strong>。疫情蔓延的这段时间，有人离开湖北，也看到了有人走进武汉，无数医护人员从各地被抽调至疫区，背负着南丁格尔与希波克拉底的教诲，走在了所有人的前面。</p>
<p>我觉得，你们真的很牛逼。</p>
<blockquote>
<p>  「whereas I was blind, now I see.」 </p>
<p>  「从前我是瞎的，如今我看得见。」</p>
</blockquote>
<p><strong>最后，是例行这一年里拍过最喜欢的十张照片。</strong></p>
<p><strong>今年相机也是吃灰的厉害。</strong></p>
<div align="center">
<img src="2019Report/s1.JPG" width=80%>
</div>



<div align="center">
<img src="2019Report/s2.JPG" width=80%>
</div>



<div align="center">
<img src="2019Report/s3.JPG" width=80%>
</div>



<div align="center">
<img src="2019Report/s4.jpg" width=80%>
</div>



<div align="center">
<img src="2019Report/s5.jpg" width=80%>
</div>



<div align="center">
<img src="2019Report/s6.jpg" width=80%>
</div>



<div align="center">
<img src="2019Report/s7.JPG" width=80%>
</div>



<div align="center">
<img src="2019Report/s8.JPG" width=80%>
</div>



<div align="center">
<img src="2019Report/s9.jpg" width=80%>
</div>



<div align="center">
<img src="2019Report/s10.jpg" width=80%>
</div>



<p><strong>你见过这个世界上的好，你见过这个世界上真的有人在过着你想要的生活，你知道你值得一切更好的东西，所以你会更加笃定，更加心无旁骛地努力。去告诉全世界，并不是只有你在做自己想做的事。</strong></p>
   </font>






      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2020/01/12/2019Report/" data-id="ckua4t7ha0004vxgtbkrw6a2k" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Dairy_2019_11_20" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/11/20/Dairy_2019_11_20/" class="article-date">
  <time class="dt-published" datetime="2019-11-20T03:01:34.000Z" itemprop="datePublished">2019-11-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="摘阅：-《向死而生》-李开复"><a href="#摘阅：-《向死而生》-李开复" class="headerlink" title="摘阅： 《向死而生》 - 李开复"></a>摘阅： 《向死而生》 - 李开复</h1><ul>
<li><p>人生中常被问到“我是谁”、“从哪里来”、“到哪里去”，其实就是认识自己，认识客观世界，寻找人生目的的过程，永远没有终点。</p>
</li>
<li><p>真正考验一个人对生命和对人生道路认识的，正是如何面对“死亡”。</p>
</li>
<li><p>每个人都应有自己对生活的追求，不要只会跟在别人的后面走同样的路，重要的恰恰在于要展现自己的性格，走出与众不同的道路，活出属于自己的生活，却并非要在墓志铭上留下些什么。</p>
</li>
<li><p>我从没想过自己竟会出版一本这样的书。一直以来，</p>
</li>
<li><p>我这一生最大的错误是，我彻头彻尾地舍本逐末，把最要紧的事搁到最后，却把人生最弥足珍贵的时光，浪费在追逐那些看起来五彩斑斓的泡沫。</p>
</li>
<li><p>因为所有的荣耀与骄傲、难堪与恐惧，都会在死亡面前消失，只留下真正重要的东西。如果觉察到自己沉溺于担心会失去某些东西时，“记住你即将死去”会是最好的解药。</p>
</li>
<li><p>说：“要珍惜、尊重周遭的一切，不论善恶美丑，都有存在的价值。就像一座生态完整的森林里，有大象、老虎，也一定有蟑螂和老鼠。完美与缺陷本来就是共存的，也是从人心产生的分别。如果没有邪恶，怎能彰显善的光芒？如果没有自私的狭隘，也无法看到慷慨无私的伟大。所以，真正有益于世界的做法不是除恶，而是行善；不是打击负能量，而是弘扬正能量。”</p>
</li>
<li><p>大师说：“要珍惜、尊重周遭的一切，不论善恶美丑，都有存在的价值。就像一座生态完整的森林里，有大象、老虎，也一定有蟑螂和老鼠。完美与缺陷本来就是共存的，也是从人心产生的分别。如果没有邪恶，怎能彰显善的光芒？如果没有自私的狭隘，也无法看到慷慨无私的伟大。所以，真正有益于世界的做法不是除恶，而是行善；不是打击负能量，而是弘扬正能量。”</p>
</li>
<li><p>“你的时间有限，所以不要为别人而活；不要被教条所限，不要活在别人的观念里；不要让别人的意见左右自己内心的声音。最重要的是，勇敢地去追随自己的心灵与直觉。只有自己的心灵和直觉才知道你自己的真实想法。其他一切都是次要的。”</p>
</li>
<li><p>“如果你刻意去做一个好人，那善良之花不会绽放。如果你刻意培养谦恭之心，结果也只会令你失望。善良和谦恭恰如一缕清风，会从你偶然开启的窗户翩然而至，但你若是有意敞开门户恭请大驾，它永远不会眷顾。”</p>
</li>
<li><p>生命还有更大的领域是我们未曾涉足的。能不能真的无惧？我真的不敢说，但是，我相信，我已经有能力将每一段经历转化成一种重要的人生学习，让我的生命可以不断地得以提升和进化。</p>
</li>
<li><p>伴随着死亡而来的肉体消亡，“个体之我”的意识也消解了，此时反而是精神、意识回归到宇宙整体大我的契机。这就是数千年来人们通过各种宗教、哲学、灵性修持等手段想要达到，却只有极少数人可以抵达的开悟状态。</p>
</li>
<li><p>就像稻盛和夫所说的：“不论你多么富有，多么有权势，当生命结束之时，所有的一切都只能留在世界上，唯有灵魂跟着你走下一段旅程。人生不是一场物质的盛宴，而是一次灵魂的修炼，使它在谢幕之时比开幕之初更为高尚。”</p>
</li>
<li><p>成功的婚姻不是建立在安全、拥有的基础之上，而是建立在平等、自由之上。婚姻不是在制造罪恶感的义务，而是彼此互补，彼此互谅，彼此互相扶持的过程。与自己最爱的人共度生命之旅，分享权力，分担责任，才能沐浴在光辉中。就像你们刚才交换的戒指：象征合一，而非占有；象征结合，而非限制；象征环抱，而非羁绊。</p>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2019/11/20/Dairy_2019_11_20/" data-id="ckua4t7hb0007vxgt7781h8ng" data-title="" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Apollo/" rel="tag">Apollo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Compose/" rel="tag">Compose</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/" rel="tag">Docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Eureka/" rel="tag">Eureka</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Gitlab/" rel="tag">Gitlab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hadoop/" rel="tag">Hadoop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hbase/" rel="tag">Hbase</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Help/" rel="tag">Help</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kubernetes/" rel="tag">Kubernetes</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MongoDB/" rel="tag">MongoDB</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NoSQL/" rel="tag">NoSQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Qt/" rel="tag">Qt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring-Cloud/" rel="tag">Spring Cloud</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Wordpress/" rel="tag">Wordpress</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/" rel="tag">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%B8%8A%E4%BD%8D%E6%9C%BA/" rel="tag">上位机</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F/" rel="tag">分布式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83/" rel="tag">分布式配置中心</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B5%8C%E5%85%A5%E5%BC%8F/" rel="tag">嵌入式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/" rel="tag">年度总结</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%91%98%E5%BD%95/" rel="tag">摘录</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%91%98%E9%98%85/" rel="tag">摘阅</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/" rel="tag">版本控制</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AC%94%E8%AE%B0/" rel="tag">笔记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93/" rel="tag">远程仓库</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%9A%8F%E7%AC%94/" rel="tag">随笔</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%AB%98%E5%8F%AF%E7%94%A8/" rel="tag">高可用</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Apollo/" style="font-size: 10px;">Apollo</a> <a href="/tags/Compose/" style="font-size: 10px;">Compose</a> <a href="/tags/Docker/" style="font-size: 16px;">Docker</a> <a href="/tags/Eureka/" style="font-size: 10px;">Eureka</a> <a href="/tags/Gitlab/" style="font-size: 12px;">Gitlab</a> <a href="/tags/Hadoop/" style="font-size: 10px;">Hadoop</a> <a href="/tags/Hbase/" style="font-size: 10px;">Hbase</a> <a href="/tags/Help/" style="font-size: 20px;">Help</a> <a href="/tags/Kubernetes/" style="font-size: 12px;">Kubernetes</a> <a href="/tags/MongoDB/" style="font-size: 10px;">MongoDB</a> <a href="/tags/NoSQL/" style="font-size: 12px;">NoSQL</a> <a href="/tags/Qt/" style="font-size: 14px;">Qt</a> <a href="/tags/Spring-Cloud/" style="font-size: 12px;">Spring Cloud</a> <a href="/tags/Wordpress/" style="font-size: 10px;">Wordpress</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/%E4%B8%8A%E4%BD%8D%E6%9C%BA/" style="font-size: 14px;">上位机</a> <a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F/" style="font-size: 10px;">分布式</a> <a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83/" style="font-size: 10px;">分布式配置中心</a> <a href="/tags/%E5%B5%8C%E5%85%A5%E5%BC%8F/" style="font-size: 14px;">嵌入式</a> <a href="/tags/%E5%B9%B4%E5%BA%A6%E6%80%BB%E7%BB%93/" style="font-size: 14px;">年度总结</a> <a href="/tags/%E6%91%98%E5%BD%95/" style="font-size: 10px;">摘录</a> <a href="/tags/%E6%91%98%E9%98%85/" style="font-size: 12px;">摘阅</a> <a href="/tags/%E7%89%88%E6%9C%AC%E6%8E%A7%E5%88%B6/" style="font-size: 10px;">版本控制</a> <a href="/tags/%E7%AC%94%E8%AE%B0/" style="font-size: 10px;">笔记</a> <a href="/tags/%E8%BF%9C%E7%A8%8B%E4%BB%93%E5%BA%93/" style="font-size: 10px;">远程仓库</a> <a href="/tags/%E9%9A%8F%E7%AC%94/" style="font-size: 18px;">随笔</a> <a href="/tags/%E9%AB%98%E5%8F%AF%E7%94%A8/" style="font-size: 10px;">高可用</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/10/">October 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/02/">February 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">December 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">October 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">September 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">January 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">November 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">October 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">September 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">June 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">January 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">January 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/10/03/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2021/02/09/toYMJ/">(no title)</a>
          </li>
        
          <li>
            <a href="/2020/12/31/2020Report/">(no title)</a>
          </li>
        
          <li>
            <a href="/2020/12/17/vuex_DOC/">(no title)</a>
          </li>
        
          <li>
            <a href="/2020/10/01/LogMonitor/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>